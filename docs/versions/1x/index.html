<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>DA-ESS-MITREContent 1.3.0 documentation</title>
    <link rel="stylesheet" href="static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="static/seynur.css" />
    <link rel="stylesheet" type="text/css" href="static/css/badge_only.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="static/documentation_options.js"></script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
  </head><body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="index.html#document-index"><h1 style="font-size: 2em;">Documentation for MITRE ATT&CK App for Splunk</h1></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li><a href="index.html#document-index">Home</a>|&nbsp;</li>
        <li><a href="index.html#document-installation">Installation</a>|&nbsp;</li>
        <li><a href="index.html#document-userguide">User Guide</a>|&nbsp;</li>
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html#document-contents">Table of Contents</a></h3>
  <ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-userguide">User Guide</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">

  <div class="toctree-wrapper compound">
<span id="document-installation"></span><div class="section" id="installation">
<span id="id1"></span><h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="download-and-install">
<span id="getting-the-app"></span><h2>Download and Install<a class="headerlink" href="#download-and-install" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><dl class="first docutils">
<dt>Download the latest AppInspect Passed version from: <a class="reference external" href="https://splunkbase.splunk.com/app/4617/">https://splunkbase.splunk.com/app/4617/</a></dt>
<dd>For the latest changes and development efforts: <a class="reference external" href="https://github.com/seynur/DA-ESS-MitreContent/">https://github.com/seynur/DA-ESS-MitreContent/</a></dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Install the application on Splunk Enterprise.  DA-ESS-MitreContent should be installed on the Search Head or Search Head Cluster where Enterprise Security Application resides.</dt>
<dd>For details on add-on installation please refer to Splunk Documentation: <a class="reference external" href="https://docs.splunk.com/Documentation/AddOns/released/Overview/Installingadd-ons">https://docs.splunk.com/Documentation/AddOns/released/Overview/Installingadd-ons</a></dd>
</dl>
</li>
</ol>
</div>
<div class="section" id="initial-setup">
<span id="id2"></span><h2>Initial Setup<a class="headerlink" href="#initial-setup" title="Permalink to this headline">¶</a></h2>
<p>Upon installation of the add-on, you may need to initially run a search to populate the lookup table.  The report simply checks for available (and enabled) Correlation Searches that are tagged for MITRE ATT&amp;CK techniques within the Analytic Stories.</p>
<ol class="arabic simple">
<li>First, please check the table at the top named “<strong>MITRE ATT&amp;CK Compliance Lookup Gen Status</strong>” for lookup table status.</li>
</ol>
<blockquote>
<div><img alt="images/mitreapp_setup1.png" src="images/mitreapp_setup1.png" />
</div></blockquote>
<ol class="arabic simple" start="2">
<li>Click on the row if the lookup table appears to be empty.  This will open a new windows with the “<strong>Mitre Compliance Lookup Gen</strong>” report.  By default this scheduled report runs daily, at 0:00. Its time range is last 24 hours.  Click <strong>Open in Search</strong> button to run this report for the first time.</li>
</ol>
<blockquote>
<div><img alt="images/mitreapp_setup2.png" src="images/mitreapp_setup2.png" />
</div></blockquote>
<ol class="arabic simple" start="3">
<li>Once the search is completed, you can go back to “MITRE ATT&amp;CK Compliance with Splunk ES” dashboard to view the level of existing rules (enabled and available) in comparison to MITRE ATT&amp;CK techniques.</li>
</ol>
<blockquote>
<div><img alt="images/mitreapp_setup3.png" src="images/mitreapp_setup3.png" />
</div></blockquote>
</div>
</div>
<span id="document-userguide"></span><div class="section" id="user-guide">
<span id="userguide"></span><h1>User Guide<a class="headerlink" href="#user-guide" title="Permalink to this headline">¶</a></h1>
<p>By default, this application comes with 2 views.</p>
<ol class="arabic simple">
<li><a class="reference internal" href="#compliance-view"><span class="std std-ref">MITRE ATT&amp;CK Compliance with Splunk ES</span></a></li>
<li><a class="reference internal" href="#triggered-attacks-view"><span class="std std-ref">MITRE ATT&amp;CK Framework Triggered Techniques</span></a></li>
<li><a class="reference internal" href="#how-to-analytic-story"><span class="std std-ref">How To Match a Correlation Search with Framework</span></a></li>
</ol>
<div class="section" id="mitre-att-ck-compliance-with-splunk-es">
<span id="compliance-view"></span><h2>MITRE ATT&amp;CK Compliance with Splunk ES<a class="headerlink" href="#mitre-att-ck-compliance-with-splunk-es" title="Permalink to this headline">¶</a></h2>
<p>Each cell containing a technique is colored based on the percentage of enabled correlation searches.</p>
<p>If there isn’t any related correlation searches, the cell is left uncolored.</p>
<p>If there are available correlation searches within Enterprise Security, then cells are colored based on percentage of enabled/active ones.</p>
<p>Currently the ranges are set as follows:</p>
<ul class="simple">
<li>low: 0-30% enabled</li>
<li>medium: 30-50% enabled</li>
<li>high: 70%+ enabled</li>
</ul>
<dl class="docutils">
<dt>You can mouse over to the cells that contain techniques in order to view the number of available and enabled correlation rules that are specific to that technique.</dt>
<dd><img alt="images/mitreapp_setup3.png" class="first last" src="images/mitreapp_setup3.png" />
</dd>
</dl>
</div>
<div class="section" id="mitre-att-ck-framework-triggered-techniques">
<span id="triggered-attacks-view"></span><h2>MITRE ATT&amp;CK Framework Triggered Techniques<a class="headerlink" href="#mitre-att-ck-framework-triggered-techniques" title="Permalink to this headline">¶</a></h2>
<p>This dashboard/form has filtering options based on “<strong>Event Time Range</strong>” and “<strong>Urgency</strong>” level of Notable Events.  Currently following panels are available:</p>
<ol class="arabic simple">
<li><strong>Triggered Tactics</strong>: Shows an overview of number of triggered Notable Events according to MITRE ATT&amp;CK tactics.</li>
<li><strong>Techniques Triggered by Notable Assets</strong>: Shows the number of triggered Notable Events according to MITRE ATT&amp;CK techniques grouped by Notable Assets.  <code class="docutils literal notranslate"><span class="pre">notable_asset</span></code> is populated by <code class="docutils literal notranslate"><span class="pre">src</span></code>, <code class="docutils literal notranslate"><span class="pre">dest</span></code> or <code class="docutils literal notranslate"><span class="pre">user</span></code> from related Data Models.</li>
<li><strong>MITRE ATT&amp;CK Framework</strong>: Provides a detailed match of triggered correlation searches with techniques and colored based on urgency level.</li>
</ol>
<img alt="images/mitreapp_attack1.png" src="images/mitreapp_attack1.png" />
</div>
<div class="section" id="how-to-match-a-correlation-search-with-framework">
<span id="how-to-analytic-story"></span><h2>How To Match a Correlation Search with Framework<a class="headerlink" href="#how-to-match-a-correlation-search-with-framework" title="Permalink to this headline">¶</a></h2>
<p>The view in the application utilized <em>Analytic Stories</em> that are tagged with the <em>Correlation Searches</em>.  Hence, in order to associate a <em>Correlation Search</em> with MITRE ATT&amp;CK Techniques, you will need to create a new <em>Analytic Story</em> and add your <em>Correlation Search</em> with the appropriate tags.</p>
<p><strong>Note:</strong> Please go to Splunk Documentation on <a class="reference external" href="https://docs.splunk.com/Documentation/ES/latest/Admin/Createcorrelationsearches">how to create a Correlation Search</a> .</p>
<p>For example, if we want the <em>Correlation Search</em> “<strong>Brute Force Access Behavior Detected</strong>” to be associated with “<strong>Brute Force</strong>” Technique under “<strong>Credential Access</strong>” tactic, we need to perform the following steps:</p>
<ol class="arabic simple">
<li>Go to “<strong>Configure –&gt; Content –&gt; Content Management</strong>” from Enterprise Security Application menu.  Click on “<strong>Create New Content</strong>” and select “<strong>Analytic Story</strong>”</li>
</ol>
<img alt="images/analyticstory1.png" src="images/analyticstory1.png" />
<ol class="arabic simple" start="2">
<li>Enter a <strong>Name</strong> and fill other details as necessary for this analytic story.  Click on “<strong>Add Search</strong>” and select “<strong>Brute Force Access Behavior Detected</strong>”</li>
</ol>
<img alt="images/analyticstory2.png" src="images/analyticstory2.png" />
<img alt="images/analyticstory3.png" src="images/analyticstory3.png" />
<ol class="arabic simple" start="3">
<li>Enter <code class="docutils literal notranslate"><span class="pre">detection</span></code> for <strong>Type</strong> field and under <strong>Annotations</strong> enter <code class="docutils literal notranslate"><span class="pre">mitre_attack</span></code> for <strong>Name</strong> and <code class="docutils literal notranslate"><span class="pre">Brute</span> <span class="pre">Force</span></code> for <strong>Mappings</strong> (this should match the technique)</li>
</ol>
<img alt="images/analyticstory4.png" src="images/analyticstory4.png" />
<ol class="arabic simple" start="4">
<li>Click <strong>Save</strong> to save the <em>Analytic Story</em> with annotation and mapping with the defined correlation search.  You can add many correlation searches under one analytic story with defined mappings.</li>
</ol>
<p>Once saved, the correlation search will populate both the Compliance and Triggered Techniques dashboards.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li><a href="index.html#document-index">Home</a>|&nbsp;</li>
        <li><a href="index.html#document-installation">Installation</a>|&nbsp;</li>
        <li><a href="index.html#document-userguide">User Guide</a>|&nbsp;</li>
        <li><a href="search.html">Search</a>|&nbsp;</li>

      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Seynur Bilgi Teknolojileri A.Ş..
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>
